
{% set repositories = {} %}
{% for source in sources %}
    {% if source.repository not in repositories %}
        {% set _ = repositories.update({source.repository: []}) %}
    {% endif %}
    {% set _ = repositories[source.repository].append(source) %}
{% endfor %}

{% for repository, repo_sources in repositories.items() %}
<div class="accordion-item bg-transparent border-light border-opacity-10 mb-2">
    <h2 class="accordion-header">
        <button class="accordion-button collapsed text-light" type="button" data-bs-toggle="collapse" data-bs-target="#{{ repository | replace('/', '_') }}Collapse">
            {{ repository }} ({{ repo_sources|length }})
        </button>
    </h2>
    <div id="{{ repository | replace('/', '_') }}Collapse" class="accordion-collapse collapse" data-bs-parent="#sourcesAccordion">
        <div class="accordion-body">
            {% for source in repo_sources %}
                <div class="source-item mb-2">
                    <a href="{{ source.url }}" target="_blank" class="text-info text-decoration-none d-flex align-items-center">
                        <span>{{ source.title }}</span>
                        <span class="ms-2 badge bg-secondary">{{ source.type }}</span>
                    </a>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endfor %}
